@import url("https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap");

@import "tailwindcss";
@source "hugo_stats.json";

/* 增强Markdown渲染样式 */
@theme {
  --font-bilingual: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
}

/* Hide elements until Alpine initializes */
[x-cloak] { display: none !important; }

/* Ensure serif font stack is actually applied when body has class */
body.font-bilingual, .font-bilingual {
  font-family: var(--font-bilingual) !important;
  /* Override default font variable used by compiled stylesheet */
  --default-font-family: var(--font-bilingual);
}

/* 表格样式增强 */
.prose table {
  @apply w-full text-left border-collapse;
}

.prose table th {
  @apply bg-gray-100 p-2 border border-gray-300 font-semibold;
}

.prose table td {
  @apply p-2 border border-gray-200;
}

/* 引用块样式增强 */
.prose blockquote {
  @apply border-l-4 border-blue-500 bg-blue-50 pl-4 py-2 my-4 italic;
}

/* Callout block: visually distinct from blockquote */
.callout {
  @apply my-6 rounded-lg shadow-sm;
  padding: 1.1rem;
  background-color: #f1f5f9; /* fallback neutral */
  box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
}

.dark .callout {
  background-color: #111827;
  box-shadow: 0 18px 45px rgba(15, 23, 42, 0.45);
}

.callout-header {
  @apply flex items-center gap-2 font-semibold mb-2;
}

.callout-icon { width: 1rem; height: 1rem; display: inline-block; }

.callout-title { color: inherit; }

/* Accent left border by type */
.callout-info { background-color: #dbeafe; }
.callout-tip { background-color: #d1fae5; }
.callout-warning { background-color: #fde68a; }
.callout-danger { background-color: #fecaca; }
.callout-neutral { background-color: #cbd5f5; }

.dark .callout-info { background-color: rgba(59, 130, 246, 0.20); }
.dark .callout-tip { background-color: rgba(16, 185, 129, 0.20); }
.dark .callout-warning { background-color: rgba(217, 119, 6, 0.25); }
.dark .callout-danger { background-color: rgba(239, 68, 68, 0.22); }
.dark .callout-neutral { background-color: rgba(148, 163, 184, 0.25); }

/* Color the header icon by type */
.callout-info .callout-header { color: #1d4ed8; }
.callout-tip .callout-header { color: #047857; }
.callout-warning .callout-header { color: #b45309; }
.callout-danger .callout-header { color: #b91c1c; }
.callout-neutral .callout-header { color: #334155; }

.dark .callout-info .callout-header { color: #bfdbfe; }
.dark .callout-tip .callout-header { color: #bbf7d0; }
.dark .callout-warning .callout-header { color: #fcd34d; }
.dark .callout-danger .callout-header { color: #fecaca; }
.dark .callout-neutral .callout-header { color: #e2e8f0; }

/* Ensure KaTeX inherits text color and handles overflow */
.callout-content .katex { color: inherit; }
.callout-content .katex-display,
.prose .katex-display {
  overflow-x: auto;
  max-width: 100%;
  padding-bottom: 0.5rem;
}
.callout-content .katex-display::-webkit-scrollbar,
.prose .katex-display::-webkit-scrollbar {
  height: 6px;
}
.callout-content .katex-display::-webkit-scrollbar-thumb,
.prose .katex-display::-webkit-scrollbar-thumb {
  background-color: rgba(148, 163, 184, 0.6);
  border-radius: 9999px;
}
.callout-content .callout-math { margin: 1rem 0; }

/* 链接样式增强 */
.prose a {
  @apply text-blue-600 hover:text-blue-800 transition-colors duration-200 underline underline-offset-2;
}

/* 标题样式增强 */
.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
  @apply font-bold text-gray-900 scroll-mt-20;
  position: relative;
}
/* Make headings feel interactive when they can be clicked to copy */
.prose h1.heading-clickable,
.prose h2.heading-clickable,
.prose h3.heading-clickable,
.prose h4.heading-clickable,
.prose h5.heading-clickable,
.prose h6.heading-clickable { cursor: pointer; }

/* 任何带 id 的内容作为锚点时，考虑固定头部的偏移量 */
.prose [id] { scroll-margin-top: 6.5rem; }

.prose h1 {
  @apply text-3xl mt-8 mb-4 pb-2 border-b border-gray-200;
}

.prose h2 {
  @apply text-2xl mt-6 mb-3 pb-1 border-b border-gray-100;
}

.prose h3 {
  @apply text-xl mt-6 mb-3;
}

/* 列表样式增强 */
.prose ul {
  @apply list-disc pl-5 space-y-1 mt-4 mb-4;
}

.prose ol {
  @apply list-decimal pl-5 space-y-1 mt-4 mb-4;
}

/* 嵌套列表更紧凑 */
.prose li > ul,
.prose li > ol {
  margin-top: .5rem;
  margin-bottom: .5rem;
}

/* 列表结束后紧跟段落/小标题时增加顶部间距 */
.prose ul + p,
.prose ol + p,
.prose ul + h2,
.prose ol + h2,
.prose ul + h3,
.prose ol + h3 {
  margin-top: 1rem;
}

/* 任务列表样式增强 */
.prose ul li.task-list-item {
  @apply list-none pl-0;
}

.prose ul li.task-list-item input[type="checkbox"] {
  @apply mr-2;
}

/* 图片样式增强 */
.prose img {
  @apply rounded-lg mx-auto shadow-md max-w-full my-6;
}

/* 水平线样式增强 */
.prose hr {
  @apply border-t-2 border-gray-200 my-8;
}

/* 脚注样式增强 */
.prose .footnotes {
  @apply text-sm text-gray-600 mt-8 pt-6 border-t border-gray-200;
}
/* 避免脚注容器自带上边框与内部 <hr> 叠加成双线 */
.prose .footnotes hr { display: none; }

/* Dark mode: improve readability for footnotes */
.dark .prose .footnotes {
  @apply text-gray-300 border-slate-700;
}
.dark .prose .footnote-backref {
  @apply text-blue-300 hover:text-blue-200 hover:bg-slate-700;
}
.dark .prose .footnote-ref,
.dark .prose sup[id^="fnref"] {
  @apply text-blue-300;
}

/* 添加脚注返回链接样式 */
.prose .footnote-backref {
  @apply ml-2 text-blue-600 no-underline hover:text-blue-800 transition-colors duration-200 text-base font-bold px-2 py-1 rounded hover:bg-blue-100;
}

/* 脚注引用样式 */
.prose .footnote-ref {
  @apply no-underline text-blue-600 hover:text-blue-800 transition-colors duration-200 font-bold;
}

/* 脚注高亮效果 */
.prose .footnote-highlight {
  @apply bg-yellow-200 transition-colors duration-500 px-2 py-1 rounded;
}

/* 脚注引用样式 */
.prose sup[id^="fnref"] {
  @apply text-blue-600;
}

/* 脚注列表样式 */
.prose .footnotes ol {
  @apply pl-5 space-y-2;
}

.prose .footnotes li {
  @apply text-gray-700;
}

/* Dark mode footnote text color fix */
.dark .prose .footnotes li,
.dark .prose .footnotes p {
  @apply text-gray-300;
}

/* Anchor highlight for in-page navigation (TOC, hash links) */
.anchor-highlight {
  background-color: #FEF3C7; /* amber-200 */
  outline: 2px solid rgba(245, 158, 11, 0.35); /* amber-500 @ 35% */
  outline-offset: 2px;
  border-radius: 6px;
  transition: background-color .4s ease, outline-color .4s ease;
}

/* Stronger emphasis for block elements */
pre.anchor-highlight,
.code-block-container.anchor-highlight,
.katex-display.anchor-highlight,
figure.anchor-highlight,
table.anchor-highlight,
blockquote.anchor-highlight {
  background-color: rgba(251, 191, 36, 0.15); /* amber-400 @ 15% */
  outline: 3px solid rgba(245, 158, 11, 0.45);
}

/* Table of Contents styling */
#TableOfContents { font-size: .95rem; }
#TableOfContents ul { list-style: none; padding-left: 0; margin: 0; }
#TableOfContents li { margin: 0; }
#TableOfContents > ul > li + li { margin-top: .35rem; }
#TableOfContents a {
  display: block;
  padding: .375rem .5rem; /* 6px 8px */
  border-radius: .375rem; /* rounded-md */
  color: #374151; /* gray-700 */
  text-decoration: none;
  transition: background-color .15s ease, color .15s ease;
}
#TableOfContents a:hover { background-color: #eef2ff; color: #1f2937; }
#TableOfContents ul ul {
  margin-top: .15rem;
  margin-left: .5rem;
  padding-left: .75rem;
  border-left: 1.5px solid #e5e7eb; /* gray-200 */
}
#TableOfContents ul ul a { font-size: .92em; padding-left: .25rem; }
/* active item */
#TableOfContents a.toc-active { background-color: #eef2ff; color: #3730a3; } /* indigo */
/* focus visibility */
#TableOfContents a:focus-visible { outline: 2px solid #93c5fd; outline-offset: 2px; }

/* Heading anchor copy button */
.heading-anchor { 
  display: inline-flex; align-items: center; justify-content: center;
  margin-left: .4rem; opacity: 0; color: #64748b; text-decoration: none;
  transition: opacity .15s ease, color .15s ease; vertical-align: middle;
}
.prose h1:hover .heading-anchor,
.prose h2:hover .heading-anchor,
.prose h3:hover .heading-anchor,
.prose h4:hover .heading-anchor,
.prose h5:hover .heading-anchor,
.prose h6:hover .heading-anchor,
.heading-anchor:focus,
.heading-anchor:focus-visible,
.heading-anchor:hover { opacity: 1; }
.heading-anchor:hover { color: #2563eb; }
.heading-anchor.copied { color: #16a34a; } /* green when copied */

/* Code block enhancements */
.code-block-container {
  @apply my-6 rounded-lg overflow-hidden border border-gray-200 shadow-md w-full;
  background-color: #ffffff;
}

/* Code block header bar */
.code-block-header {
  @apply flex justify-between items-center px-4 py-2 text-sm w-full;
  background-color: #f6f8fa;
  border-bottom: 1px solid #e1e4e8;
}

/* Language label */
.code-language-label {
  @apply px-2 py-1 rounded font-mono text-xs uppercase tracking-wider;
  color: #24292e;
  background-color: #e1e4e8;
}

/* Copy button */
.copy-button {
  @apply flex items-center space-x-1 px-2 py-1 rounded text-xs transition-colors duration-200;
  color: #24292e;
  background-color: #f6f8fa;
  border: 1px solid #e1e4e8;
}

.copy-button:hover {
  background-color: #e1e4e8;
}

.copy-button svg {
  @apply w-4 h-4 inline-block mr-1;
}

/* Code block styles */

.code-block-container pre {
  @apply p-4 overflow-x-auto m-0 w-full;
  background-color: transparent;
  border: none;
  color: inherit;
}

.code-block-container pre code {
  @apply w-full inline-block;
  white-space: pre-wrap;
  word-break: break-word;
  overflow-wrap: anywhere;
  line-height: 1.5rem;
  background-color: transparent;
  padding: 0;
  font-size: 14px;
}

/* Fallback code blocks rendered without container */
.prose pre {
  @apply p-4 rounded-md text-sm overflow-x-auto;
  background-color: #f1f5f9;
  color: #0f172a;
  white-space: pre-wrap;
  word-break: break-word;
  overflow-wrap: anywhere;
}

.dark .prose pre {
  background-color: rgba(15, 23, 42, 0.92);
  color: #e2e8f0;
}

.prose pre code {
  white-space: inherit;
  word-break: inherit;
  overflow-wrap: inherit;
  display: block;
  color: inherit;
}

/* Inline code wrapping */
.prose code {
  @apply px-1 py-0.5 rounded bg-slate-200 text-slate-800;
  white-space: pre-wrap;
  word-break: break-word;
  overflow-wrap: anywhere;
}

.dark .prose code {
  background-color: rgba(15, 23, 42, 0.75);
  color: #e2e8f0;
}

/* 禁止Disqus广告 */
div#disqus_thread iframe[sandbox] {
  max-height: 0px !important;
}

/* Improve spacing for paragraphs inside article content */
.prose p { margin-bottom: 1rem; }
.prose p + p { margin-top: 1rem; }

/* --------------------------- */
/* Dark mode overrides         */
/* --------------------------- */
/* Animated theme toggle icons (cross-fade + rotate) */
.theme-toggle { position: relative; }
.theme-toggle .icon-sun,
.theme-toggle .icon-moon {
  position: absolute;
  inset: 0;
  transition: opacity .25s ease, transform .25s ease, color .2s ease;
  vertical-align: middle;
  pointer-events: none;
}
.icon-sun { opacity: 1; transform: rotate(0deg) scale(1); }
.icon-moon { opacity: 0; transform: rotate(-90deg) scale(.6); }
.dark .icon-sun { opacity: 0; transform: rotate(90deg) scale(.6); }
.dark .icon-moon { opacity: 1; transform: rotate(0deg) scale(1); }
.theme-toggle-btn { transition: transform .15s ease, color .2s ease; cursor: pointer; }
.theme-toggle-btn:active { transform: scale(0.92); }
/* Hover affordance */
.theme-toggle-btn:hover { transform: scale(1.08); }
.theme-toggle-btn:hover .icon-sun { transform: rotate(12deg) scale(1.08); }
.theme-toggle-btn:hover .icon-moon { transform: rotate(-12deg) scale(1.08); }
/* Keyboard focus */
.theme-toggle-btn:focus-visible { outline: none; box-shadow: 0 0 0 3px rgba(59,130,246,.45); border-radius: 6px; }
@media (prefers-reduced-motion: reduce) {
  .theme-toggle .icon-sun,
  .theme-toggle .icon-moon,
  .theme-toggle-btn { transition: none !important; }
}
.dark body { background-color: #0b1220 !important; }
.dark .bg-white { background-color: #0f172a !important; }
.dark .bg-gray-100 { background-color: #111827 !important; }
.dark .border-gray-100 { border-color: #1f2937 !important; }
.dark .bg-gray-50 { background-color: #0b1220 !important; }
.dark .border-gray-200 { border-color: #334155 !important; }
.dark .text-gray-900 { color: #e5e7eb !important; }
.dark .text-gray-800 { color: #e5e7eb !important; }
.dark .text-gray-700 { color: #e5e7eb !important; }
.dark .text-gray-600 { color: #cbd5e1 !important; }
.dark .text-gray-500 { color: #94a3b8 !important; }
.dark .text-blue-700 { color: #93c5fd !important; }

.dark .prose { color: #e5e7eb; }
.dark .prose a { color: #60a5fa; }
.dark .prose a:hover { color: #93c5fd; }
.dark .prose h1,
.dark .prose h2,
.dark .prose h3,
.dark .prose h4,
.dark .prose h5,
.dark .prose h6 { color: #e5e7eb; }

/* 全局标题在暗色模式下的可读性 */
.dark h1, .dark h2, .dark h3, .dark h4, .dark h5, .dark h6 { color: #e5e7eb !important; }
.dark .prose h1 { border-color: #374151; }
.dark .prose h2 { border-color: #1f2937; }
.dark .prose hr { border-color: #334155; }

.dark #toc-content { background-color: #0f172a; border-color: #1f2937; }
.dark #TableOfContents a { color: #e5e7eb; }
.dark #TableOfContents a:hover { background-color: #1e293b; color: #e5e7eb; }
.dark #TableOfContents a.toc-active { background-color: #1e293b; color: #93c5fd; }
.dark #TableOfContents ul ul { border-left-color: #334155; }

.dark .code-block-container { background-color: #0b1220; border-color: #1f2937; }
.dark .code-block-header { background-color: #111827; color: #e5e7eb; border-color: #1f2937; }
.dark .code-language-label { background-color: #374151; color: #e5e7eb; }
.dark .copy-button { background-color: #111827; color: #e5e7eb; border-color: #374151; }
.dark .copy-button:hover { background-color: #1f2937; }

.dark .anchor-highlight { background-color: rgba(245, 158, 11, 0.18); outline-color: rgba(245, 158, 11, 0.5); }

/* theme card (e.g., disqus container) */
.dark .theme-card { background-color: #0f172a !important; }

/* About page card separation in dark mode */
.dark .about-card { background-color: #0f172a !important; border: 1px solid #1f2937 !important; }

/* Dark-mode hover adjustments to avoid bright white backgrounds */
.dark .hover\:bg-gray-50:hover { background-color: #1f2937 !important; }
.dark .hover\:bg-gray-100:hover { background-color: #1f2937 !important; }
.dark .hover\:bg-blue-50:hover { background-color: rgba(59,130,246,0.18) !important; }
.dark .bg-blue-50 { background-color: rgba(59,130,246,0.18) !important; }

/* -------- Tag chips dark mode fallback (works even if Tailwind dark: classes are purged) -------- */
.dark .tag-chip { background-color: #1f2937 !important; color: #cbd5e1 !important; border-color: #334155 !important; }
.dark .tag-chip:hover { background-color: #334155 !important; color: #93c5fd !important; }
.dark .tag-chip .count-badge { background-color: #374151 !important; color: #93c5fd !important; }
.dark .tags-container a { background-color: #1f2937 !important; color: #93c5fd !important; }
.dark .tags-container a:hover { background-color: #334155 !important; }

/* -------- Inline code & blockquotes: light + dark adaptations -------- */
/* Inline code (avoid pre>code) */
.prose :not(pre) > code {
  background-color: #f3f4f6;
  color: #111827;
  padding: .125rem .35rem;
  border-radius: .375rem; /* rounded-md */
  border: 1px solid #e5e7eb;
  box-shadow: inset 0 1px 0 rgba(0,0,0,.04);
  font-size: .95em;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
.dark .prose :not(pre) > code {
  background-color: #0f172a;
  color: #e5e7eb;
  border-color: #374151;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
}

/* Blockquote dark mode */
.dark .prose blockquote {
  border-color: #60a5fa; /* blue-400 */
  background-color: rgba(59, 130, 246, 0.12); /* blue-500 @ 12% */
}
